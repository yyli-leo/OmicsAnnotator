# OmicsNavigator

A **large‚Äëlanguage‚Äëmodel (LLM)** driven multi‚Äëagent framework that turns raw spatial‚Äëomics images and tables into human‚Äëreadable biological knowledge.
![Overview of OmicsNavigator](figs/workflow.png)
---

## 1. Project overview

Spatial omics delivers unprecedented, sub‚Äëcellular views of tissue architecture, yet its analysis remains difficult because of

- terabyte‚Äëscale images,
- hierarchical spatial organisation, and
- the need for expert biological interpretation.

**OmicsNavigator** addresses these challenges with a *multi‚Äëagent system* powered by general‚Äëpurpose LLMs (no domain‚Äëspecific fine‚Äëtuning).  It

1. **encodes** spatial data into concise natural‚Äëlanguage summaries,
2. performs **zero‚Äëshot structural annotation** of tissue components,
3. provides **quantitative pathology relevance** scoring, and
4. enables **free‚Äëtext semantic search** for regions of interest.

The system has been benchmarked on several multiplexed immunofluorescence (mIF) kidney cohorts (healthy, DM, DKD, transplantation) and consistently excels at structural annotation, pathology assessment, and cross‚Äëstudy semantic retrieval ‚Äì all in a scalable, modality‚Äëagnostic, and interpretable manner.

---

## 2. Repository structure

```
OmicsNavigator/
‚îú‚îÄ‚îÄ agents/               # All LLM agents & prompt templates
‚îÇ   ‚îú‚îÄ‚îÄ context_curator.py
‚îÇ   ‚îú‚îÄ‚îÄ omics_encoder.py
‚îÇ   ‚îú‚îÄ‚îÄ omics_annotator.py
‚îÇ   ‚îú‚îÄ‚îÄ omics_annotator_aggregate.py
‚îÇ   ‚îî‚îÄ‚îÄ pathology_scorer.py
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îú‚îÄ‚îÄ auto_workflow.py      # End‚Äëto‚Äëend pipeline with checkpoint‚Äëresume support
‚îú‚îÄ‚îÄ data/                 # Lightweight demo metadata & helper scripts
‚îÇ   ‚îî‚îÄ‚îÄ DKD/ s255 | s314 | s515 / metadata.yaml
‚îú‚îÄ‚îÄ memory/               # Checkpoints generated by auto_workflow / notebook
‚îú‚îÄ‚îÄ patchsum/             # Helper functions for image / cell feature handling
‚îú‚îÄ‚îÄ example.ipynb         # Tutorial notebook with three case‚Äëstudies
‚îî‚îÄ‚îÄ background_context.pkl# Pre‚Äëbuilt study‚Äëlevel context produced by ContextCurator
```

**Key components**

- `` **example.ipoynb**‚Äì step‚Äëby‚Äëstep usage guide covering metadata loading, ROI annotation, SCGP cluster annotation, and *three* biological case‚Äëstudies.
- `` **auto_workflow.py**‚Äì fully automated CLI pipeline that builds the `memory/` artefacts (region objects, LLM outputs, etc.) with *checkpoint & resume*; ideal for large datasets or headless servers.
- `` **agents/**‚Äì self‚Äëcontained LLM agents; each agent loads its YAML prompt at runtime to keep logic and prompt separate.

---

## 3. Installation

```bash
# create an isolated env (optional but recommended)
conda create -n omicsnav python=3.11
conda activate omicsnav

# install core dependencies
pip install -r requirements.txt
```
### Install SCGP
We rely on SCGP for unsupervised clustering of spatial cellular graphs.
Please follow the official instructions to install SCGP from its repository:
üëâ https://gitlab.com/enable-medicine-public/scgp

For most users, this can be done via:
```bash
git clone https://gitlab.com/enable-medicine-public/scgp.git
cd scgp
python setup.py install
```

> **Note** ‚Äì You need a valid OpenAI (or Azure OpenAI) API key in your environment, e.g. `openai.api_key = "Your own key" in agents/base_agent.py.

---

## 4. Data availability

- **s255** (DKD) and **s515** (post‚Äëtransplant rejection) are fully open‚Äësourced at **Zenodo**: [https://zenodo.org/records/12682727](https://zenodo.org/records/12682727)
- **s314** contains three representative transplant‚Äêrejection samples and is shipped inside the `data/` folder.

Because of data size constraints, the repository does not include the raw multi‚Äëgigabyte image files required for reproducing the plots shown in our paper. Consequently, the example.ipynb cannot directly run the provided image-plotting code for ROI visualisation.

We are preparing a down‚Äësampled public release of those image tiles; stay tuned!

---

Enjoy exploring your spatial omics data with **OmicsNavigator**.  Bug reports & pull requests are welcome.

